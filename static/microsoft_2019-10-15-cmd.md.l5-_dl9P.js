import{_ as i,c as a,o as t,ag as n}from"./chunks/framework.BeMlo_ux.js";const h="/static/20190326170148.LWIDHXE_.png",g=JSON.parse('{"title":"CMD","description":"","frontmatter":{"title":"CMD","date":"2019-10-15T18:26:32.000Z","outline":"deep"},"headers":[],"relativePath":"microsoft/2019-10-15-cmd.md","filePath":"microsoft/2019-10-15-cmd.md","lastUpdated":1747924457000}'),l={name:"microsoft/2019-10-15-cmd.md"};function p(k,s,e,d,r,F){return t(),a("div",null,s[0]||(s[0]=[n('<h3 id="console-命令" tabindex="-1">Console 命令 <a class="header-anchor" href="#console-命令" aria-label="Permalink to &quot;Console 命令&quot;">​</a></h3><table tabindex="0"><thead><tr><th>功能键</th><th>使用说明</th><th>备注</th></tr></thead><tbody><tr><td>F7</td><td>查看命令提示符历史记录</td><td>按Esc键退出</td></tr><tr><td>向下箭头</td><td>重新输入您键入的下一个命令</td><td>如果您反复按箭头键，它将向下滚动当前内存中的命令历史记录</td></tr><tr><td>向上箭头</td><td>重新输入您键入的上一个命令</td><td>如果您反复按箭头键，它将向上滚动当前内存中的命令历史记录</td></tr><tr><td>Page Down</td><td>从当前会话历史记录中重新输入最后一个命令</td><td></td></tr><tr><td>Page Up</td><td>从当前会话历史记录中重新输入第一个命令</td><td></td></tr><tr><td>Esc</td><td>删除控制台行的当前内容</td><td></td></tr></tbody></table><table tabindex="0"><thead><tr><th>命令</th><th>说明</th></tr></thead><tbody><tr><td>bash</td><td>----</td></tr><tr><td>cmd</td><td>----</td></tr><tr><td>help</td><td></td></tr><tr><td>curl</td><td></td></tr><tr><td>calc</td><td></td></tr><tr><td>control</td><td></td></tr><tr><td>dxdiag</td><td></td></tr><tr><td>ftp.exe</td><td></td></tr><tr><td>winver</td><td></td></tr><tr><td>openfiles</td><td></td></tr><tr><td>xcopy</td><td></td></tr><tr><td>taskkill</td><td></td></tr><tr><td>tasklist</td><td></td></tr><tr><td>telnet</td><td></td></tr><tr><td>tcpsvcs</td><td></td></tr></tbody></table><p>ping www.baidu.com<br> netstat –ano | findstr 8080</p><table tabindex="0"><thead><tr><th>explorer 图形可视化界面</th><th>说明</th></tr></thead><tbody><tr><td>explorer .</td><td>打开当前目录</td></tr><tr><td>explorer ..</td><td>打开上级目录</td></tr><tr><td>explorer dirname</td><td>打开指定任意目录</td></tr><tr><td>explorer &quot;d:\\Program Files (x86)&quot;</td><td>打开指定任意目录</td></tr></tbody></table><h3 id="system-fold-shortcut-command" tabindex="-1">System fold Shortcut Command <a class="header-anchor" href="#system-fold-shortcut-command" aria-label="Permalink to &quot;System fold Shortcut Command&quot;">​</a></h3><ul><li>打开资源管理器地址栏 或者 打开CMD命令</li><li>输入以下命令,则跳转到对应的文件夹</li></ul><table tabindex="0"><thead><tr><th>命令</th><th>路径</th></tr></thead><tbody><tr><td>%APPDATA%</td><td>C:Users\\用户名\\AppData\\Roaming</td></tr><tr><td>%ALLUSERSPROFILE%</td><td>C:\\ProgramData</td></tr><tr><td>%APPDATA%</td><td>C:\\Users\\用户名\\AppData\\Roaming</td></tr><tr><td>%COMMONPROGRAMFILES%</td><td>C:\\Program Files\\Common Files</td></tr><tr><td>%COMMONPROGRAMFILES(x86)%</td><td>C:\\Program Files (x86)\\Common Files</td></tr><tr><td>%COMSPEC%</td><td>C:\\Windows\\System32\\cmd.exe</td></tr><tr><td>%HOMEDRIVE%和%SystemDrive%</td><td>C:\\</td></tr><tr><td>%HOMEPATH%</td><td>C:\\Users\\用户名</td></tr><tr><td>%LOCALAPPDATA%</td><td>C:\\Users\\用户名\\AppData\\Local</td></tr><tr><td>%PROGRAMDATA%</td><td>C:\\ProgramData</td></tr><tr><td>%PROGRAMFILES%</td><td>C:\\Program Files</td></tr><tr><td>%PROGRAMFILES(X86)%</td><td>C:\\Program Files (x86)</td></tr><tr><td>%PUBLIC%</td><td>C:\\UsersPublic</td></tr><tr><td>%SystemRoot%</td><td>C:\\Windows</td></tr><tr><td>%TEMP%和%TMP%</td><td>C:\\Users\\用户名\\AppData\\LocalTemp</td></tr><tr><td>%USERPROFILE%</td><td>C:\\Users 用户名</td></tr><tr><td>%WINDIR%</td><td>C:\\Window</td></tr></tbody></table><h3 id="mklink-d和-j的区别" tabindex="-1">mklink /D和/J的区别 <a class="header-anchor" href="#mklink-d和-j的区别" aria-label="Permalink to &quot;mklink /D和/J的区别&quot;">​</a></h3><ol><li>/D 指向Source 目录 保存目录路径不占用目录空间</li><li>/J 指向Source 目录 保存目录路径占用目录空间</li><li>/H 硬链接只能用于文件，不能用于文件夹</li></ol><p><img src="'+h+`" alt="view"></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D:\\Desktop\\Target</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mklink</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">esktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ource</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">为</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">===&gt;&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> D:\\Desktop\\Source</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 创建的符号链接</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">D:\\Desktop\\Target&gt;mklink /J JSource D:\\Desktop\\Source</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">为 JSource &lt;&lt;===&gt;&gt; D:\\Desktop\\Source 创建的联接</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"># 如果是不同的文件系统,会出现系统无法将文件移到不同的磁盘驱动器</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">D:\\Desktop\\Target&gt;mklink /H readme.txt D:\\Desktop\\Source\\test.txt</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">为 readme.txt &lt;&lt;===&gt;&gt; D:\\Desktop\\Source\\test.txt 创建了硬链接</span></span></code></pre></div><h3 id="卸载软件历史记录" tabindex="-1">卸载软件历史记录 <a class="header-anchor" href="#卸载软件历史记录" aria-label="Permalink to &quot;卸载软件历史记录&quot;">​</a></h3><ol><li>cmd to regedit 打开注册表定位[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\windows\\CurrentVersion\\Uninstall]</li><li>从文件夹里看 DisplayName 属性 直到找到符合你要删除的软件名</li><li>从文件夹里看 InstallSource 属性，看到有路径，去文件夹里找到这个路径下的文件，如果需要修复或者卸载，卸载软件即可。</li></ol><h3 id="doskey" tabindex="-1"><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/doskey" target="_blank" rel="noreferrer">dosKey</a> <a class="header-anchor" href="#doskey" aria-label="Permalink to &quot;[dosKey](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/doskey)&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 记录以前敲过的dos命令,可以用F7来显示,用&quot;↑↓&quot;来选择,用F9来输入选择的命令号. or F7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">d:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Desktop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doskey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /history</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doskey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /history</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:test.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doskey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> d:test.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">doskey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> c:cmd_history.txt</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 快速跳转</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:\\Users\\Desktop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">d:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Desktop</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D:\\Desktop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="校验文件" tabindex="-1">校验文件 <a class="header-anchor" href="#校验文件" aria-label="Permalink to &quot;校验文件&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取hash值 打开PowerShell命令校验文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">eskto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get-filehash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">esktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">est.md</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Algorithm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SHA1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取hash值 打开cmd命令校验文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">D:\\Desktop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">certutil</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -hashfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">esktop</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">est.md</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> md5</span></span></code></pre></div><h3 id="移除-windows-图标快捷方式小箭头" tabindex="-1">移除 Windows 图标快捷方式小箭头 <a class="header-anchor" href="#移除-windows-图标快捷方式小箭头" aria-label="Permalink to &quot;移除 Windows 图标快捷方式小箭头&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 管理员权限打开 CMD</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 会移除所有带快捷方式的图标小箭头，此后创建的任何快捷方式都不带小箭头</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">reg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;HKEY_CLASSES_ROOT\\lnkfile&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> IsShortcut</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">taskkill</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /im</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> explorer.exe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> explorer.exe</span></span></code></pre></div><h3 id="命令行管理员权限" tabindex="-1">命令行管理员权限 <a class="header-anchor" href="#命令行管理员权限" aria-label="Permalink to &quot;命令行管理员权限&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ps 管理员权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Start-Process</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Verb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RunAs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Start-Process</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Verb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RunAs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">powershell</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> powershell</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -verb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> runas</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cmd 管理员权限 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">powershell</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -verb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> runas</span></span></code></pre></div><p>cmdas.bat -&gt; Environment -&gt; win+r -&gt; cmd -&gt; cmdas</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> off</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">powershell</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -verb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> runas</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">exit</span></span></code></pre></div><h3 id="hyper-v" tabindex="-1">Hyper-V <a class="header-anchor" href="#hyper-v" aria-label="Permalink to &quot;Hyper-V&quot;">​</a></h3><ul><li><p>关闭Hyper-V<br> bcdedit /set hypervisorlaunchtype off</p></li><li><p>打开Hyper-V<br> bcdedit /set hypervisorlaunchtype auto</p><p>重启电脑后生效</p></li></ul><h3 id="文件合并" tabindex="-1">文件合并 <a class="header-anchor" href="#文件合并" aria-label="Permalink to &quot;文件合并&quot;">​</a></h3><p>copy /b 13.png+12.zip test.jpg -&gt; test.rar -&gt; open</p><h3 id="自释放" tabindex="-1">自释放 <a class="header-anchor" href="#自释放" aria-label="Permalink to &quot;自释放&quot;">​</a></h3><div class="language-bat vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bat</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 单文件拖动</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@echo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> off</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: -r 开启递归子目录</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: -r- 关闭递归子目录</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: -x 指定某一文件或某一类文件从操作中排除</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: 不删除源文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: rar.exe a -epl -k -r -sfx -m5 &quot;%~dp1%num%.exe&quot; %1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: 删除源文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: rar.exe m -epl -k -r -sfx -m5 &quot;%~dp1%num%.exe&quot; %1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: 将所有 *.txt 文件添加到自释放档案 </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: a.exe 7z a -sfx a.exe *.txt</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: set zip7=C:\\Program Files\\7-Zip\\7z.exe</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">:: &quot;%zip7%&quot; a -sfx7zCon.sfx -mx9 &quot;%~dp1%num%_7z.exe&quot; * -r</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /s /q %appdata%\\7z </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">md</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %appdata%\\7z</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zipPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%appdata%\\7z</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> filePath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %filePath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> copying</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">copy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %filePath% %zipPath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fileName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%~n1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %fileName%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">7z a -sfx7zCon.sfx -mx9 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%fileName%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">_7z.exe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%\\* -x!*.bat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> pause</span></span></code></pre></div><p>限制单文件 copy 多文件到目录</p><div class="language-bat vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bat</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@echo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> off</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">rd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /s /q %appdata%\\7z </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">md</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %appdata%\\7z</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zipPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%appdata%\\7z</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Loop</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%~1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> equ</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> goto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">eof</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">copy</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> %~1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">shift</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">goto</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">loop</span></span></code></pre></div><p>批量拖动文件夹生成自解压文件</p><div class="language-bat vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bat</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@echo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> off</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zipPath</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%appdata%\\7z</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> exist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath% (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    rd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /s /q %zipPath% </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">md</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /D </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%%i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> %%i</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%%~ni</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%%~nxi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%\\</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%%~ni</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    md</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%\\</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%%~ni</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    copy</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> %%i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%\\</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">%%~ni</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    copy</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> %%i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> year</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%date:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> month</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%date:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> day</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%date:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%time:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hour</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%time0:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fileName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%year%%month%%day%%hour%%time:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%%time:~</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">7z a -sfx7zCon.sfx -mx9 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">%fileName%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">_7z.exe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> %zipPath%\\* -x!*.bat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> pause</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#获取环境变量 powershell</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get-ChildItem</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Env:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span></code></pre></div>`,36)]))}const o=i(l,[["render",p]]);export{g as __pageData,o as default};
